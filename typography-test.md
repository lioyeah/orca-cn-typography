# 中文高级排版测试文档

本文件用于系统性验证插件的显示层排版增强能力，并提供“期望生效结果”与“未生效示例”的并排对照，便于他人复现与判断。

## 开关参考
- 空格增强：开启“智能中英数字间距”“增强空格规则”
- 标点与引号：开启“标点/引号规范预览”，按需开启“增强标点规则”，并选择“引号风格”
- 数字对齐：开启“表格数字对齐”
- 代码不变：代码区不应被改动

## 场景测试（结构化）

### 场景：中文与英文/数字间自动空格
示例文本：在LeanCloud上数据存储是围绕AVObject进行的。
判定标准：
- “在LeanCloud上”应显示为“在 LeanCloud 上”
- “AVObject进行”应显示为“AVObject 进行”
- 若未生效，上述位置之间不会出现空格
结果补充：
- 驼峰英文词（如 AVObject）本身不被拆分，仅在中英文边界处加空格
- 链接与代码区不参与该空格逻辑

### 场景：中文与数字间自动空格
示例文本：今天出去买菜花了5000元。
判定标准：
- “5000元”应显示为“5000 元”
- 若未生效，“5000”和“元”之间没有空格
结果补充：
- 千分位标记、负号等保持原样，仅在中文与数字的边界加空格
- 代码或表格原始数据不被更改

### 场景：数字与单位（白名单）之间加空格
示例文本：我家的光纤入户宽带有10Gbps，SSD一共有20TB，字号16px，延迟10ms。
判定标准：
- “10Gbps”应显示为“10 Gbps”
- “20TB”应显示为“20 TB”
- “16px”应显示为“16 px”
- “10ms”应显示为“10 ms”
结果补充：
- 单位列表由设置 `unitWhitelist` 控制，可按需扩展（大小写敏感）
- 单位与前后标点不会被改变，只在数字与单位之间插入空格

### 场景：例外单位（°、% 等）不加空格
示例文本：今天是233 ° 的高温。新 MacBook Pro 有 15 % 的 CPU 性能提升。
判定标准：
- “233 °”应显示为“233°”（去除数字与度符之间空格）
- “15 %”应显示为“15%”（去除数字与百分号之间空格）
结果补充：
- 非标准字符（如不同字体的圈号）不参与该例外匹配
- 若原文本无空格，不做任何插入操作

### 场景：URL 前后自动空格
示例文本：请参考https://example.com链接获取详情。
判定标准：
- “参考https://example.com链接”应显示为“参考 https://example.com 链接”
结果补充：
- 仅在 URL 左右边界添加空格，不改变链接本体
- 不在 URL 内部插入空格

### 场景：全角标点前后多余空格移除
示例文本：刚刚买了一部 iPhone ，好开心！ （ 这是一个开头）我们继续。
判定标准：
- “iPhone ，”应显示为“iPhone，”（逗号前空格被移除）
- “（ 这是”应显示为“（这是”（开口标点后空格被移除）
结果补充：
- 该规则主要针对中文全角标点，英文半角标点不处理
- 开口标点（如 “（”““”“‘”）后的多余空格会被移除

### 场景：引号风格转换
示例文本：他说 "你好" 然后走了。 “老师，‘有条不紊’的‘紊’是什么意思？”
判定标准：
- mainland 风格：“你好”应显示为中文双引号；内层中文引号为‘ ’，外层为“ ”
- tw-hk 风格：应显示为「你好」；内层为『…』
- tech 风格：保留 ASCII 引号不变："你好"
结果补充：
- 混合中英文场景下，仅中文语境的引号参与风格转换
- 代码区与链接文本不进行引号风格转换

### 场景：数字表格对齐
示例表格：
| 项目 | 数值 |
|---|---:|
| A | 7 |
| B | 42 |
| C | 365 |
| D | 1024 |
判定标准：
- 右侧数字列视觉上垂直对齐（启用等宽数字）
结果补充：
- 等宽数字样式应用于 `body/.markdown-body/main/article` 等常见容器
- 不同字体对等宽数字的表现可能略有差异

### 场景：代码区保持不变
示例代码：
```js
const text = "在LeanCloud上数据存储是围绕AVObject进行的";
const speed = "10Gbps";
const size = "20TB";
function sum(a, b) { return a + b; }
```
判定标准：
- 代码块内的文本不发生任何空格或引号变更
结果补充：
- 会跳过 `code/pre/kbd/samp`、链接 `A` 标签、可编辑区域 `contenteditable/textarea/input`
- 若发现代码被改动，通常是页面作用范围选择器设置不当

### 场景：自定义规则触发（单位扩展）
示例文本：容量20MB，频率2GHz，频率500MHz，大小64KB，响应10ms，时间5s。
判定标准：
- 若 `unitWhitelist` 包含相应单位，应显示为“20 MB”“2 GHz”“500 MHz”“64 KB”“10 ms”“5 s”
结果补充：
- `customSpacingRules/customPunctuationRules` 的 JSON 规则按序执行，可覆盖默认行为
- 无效正则或替换将被忽略，不影响其它规则

### 场景：多级列表文本规范
示例文本：
- 第一层：今天出去买菜花了5000元，宽带10Gbps，SSD20TB。
  - 第二层：引用 "你好" ，（ 这是开头）继续说明；链接https://example.com获取详情。
    - 第三层：在LeanCloud上数据存储是围绕AVObject进行的；字号16px；响应10ms。
- 另一项：容量20MB、大小64KB；时间5s；频率2GHz/500MHz。
  1. 序号一：中文English混合在LeanCloud上AVObject进行。
  2. 序号二：今天是233 ° 的高温，提升 15 %。

判定标准：
- 自动空格：中文与英文/数字边界处加空格，如“在LeanCloud上”→“在 LeanCloud 上”“AVObject进行”→“AVObject 进行”。
- 单位空格：`10Gbps/20TB/16px/10ms/20MB/64KB/5s/2GHz/500MHz` 应显示为 `10 Gbps/20 TB/16 px/10 ms/20 MB/64 KB/5 s/2 GHz/500 MHz`。
- 例外单位：`233 °`→`233°`，`15 %`→`15%`。
- URL 两侧：`链接https://example.com获取详情`→`链接 https://example.com 获取详情`。
- 标点空格：`"你好" ，`→`"你好"，`；`（ 这是`→`（这是`；列表结构与缩进不被破坏。
- 引号风格：中文语境的引号按当前风格转换（如 `tw-hk` →「」/『』）；代码/链接文本不转换。

结果补充：
- 列表项的 `-`、数字序号与缩进层级不应被更改；只对文本内容进行显示层规范化。
- 若发现变换影响了列表层级，通常是选择器或容器设置不当，应回退到 `.markdown-body`。
